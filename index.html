<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beach Kitten Cleanup</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <!-- Menú overlay -->
    <div id="menu" class="menu-overlay">
      <h1>Beach Kitten Cleanup</h1>
      <button id="startBtn">Iniciar juego</button>
      <div style="margin-top:8px;">
        <button id="chooseCharacterBtn" style="padding:10px 14px; font-size:16px;">Seleccionar personaje</button>
      </div>
      <div style="margin-top:8px; display:flex; gap:8px; align-items:center; justify-content:center;">
        <label for="multiplayerCheckbox" class="menu-toggle-label">
          <input id="multiplayerCheckbox" type="checkbox" />
          <span class="menu-toggle-text">Multijugador</span>
        </label>
      </div>
      <button id="levelsBtn">Niveles</button>
      <div style="margin-top:8px;">
        <button id="howToBtn" style="padding:10px 14px; font-size:16px;">¿Cómo jugar?</button>
      </div>
      <div style="margin-top:8px;">
        <button id="settingsBtn" style="padding:10px 14px; font-size:16px;">Configuraciones</button>
      </div>
      <button id="exitBtn">Salir</button>

      <div id="levelsPanel" class="hidden">
        <label>Selecciona nivel:
          <select id="levelSelect">
            <option value="1">Nivel 1</option>
            <option value="2">Nivel 2</option>
            <option value="3">Nivel 3</option>
          </select>
        </label>
        <button id="startWithLevelBtn">Iniciar</button>
        <button id="backBtn">Volver</button>
      </div>
      
      
    </div>

    </div>

    <!-- Overlay de 'Cómo jugar' -->
    <div id="howToOverlay" class="menu-overlay hidden">
      <div id="howToPanel" style="text-align:left; padding:20px; background:white; border-radius:12px; min-width:360px; max-width:640px;">
        <h2 style="margin:0 0 8px 0; text-align:center;">¿Cómo jugar?</h2>
        <div style="font-size:15px; line-height:1.45; text-align:left;">
          <p><strong>Objetivo:</strong> Recoger la cantidad de basuras indicada en cada nivel antes de quedarte sin vidas.</p>
          <p><strong>Modos de juego:</strong></p>
          <ul>
            <li><strong>Un jugador:</strong> Controlas al gatito principal (Jugador 1). En este modo solo verás un contador de basura y el indicador de vidas del Jugador 1.</li>
            <li><strong>Multijugador local:</strong> Marca <em>Multijugador</em> en el menú antes de iniciar. Aparecerá un segundo gatito (Jugador 2) que te ayudará a recoger basura y ambos tienen vidas independientes.</li>
          </ul>
          <p><strong>Controles:</strong></p>
          <ul>
            <li><strong>Jugador 1:</strong> <em>W A S D</em> (o Flechas, según configuración) — Mover al gatito.</li>
            <li><strong>Jugador 2:</strong> <em>I J K L</em> por defecto (o Flechas si eliges esa opción en Configuraciones) — Mover al ayudante.</li>
            <li><strong>ESC:</strong> Pausar y abrir menú de pausa (ambos jugadores comparten la pausa).</li>
          </ul>
          <p><strong>Vidas y peligros:</strong> Cada jugador tiene su propio conjunto de vidas (por ejemplo 3). Obstáculos como tiburón, cangrejo y faro quitan vidas al jugador que los toca. Si un jugador pierde sus vidas queda inhabilitado (aparece la calavera) pero el otro puede continuar.</p>
          <p><strong>Recoger basura:</strong> Ambos jugadores pueden recoger basura. El progreso del nivel se calcula con la suma de lo recogido por ambos (en multijugador) o por el único jugador (en modo single).</p>
          <p><strong>Selección de personaje:</strong> Usa <em>Seleccionar personaje</em> en el menú para asignar el aspecto al Jugador 1 o Jugador 2 antes de iniciar.</p>
          <p><strong>Progreso y mejor tiempo:</strong> Verás un contador de basuras y una barra de progreso en pantalla. El juego guarda el mejor tiempo por nivel y se muestra en la esquina superior izquierda.</p>
          <p>¡Buena suerte y limpiad la playa juntos!</p>
        </div>
        <div style="margin-top:12px; display:flex; gap:10px; justify-content:center;">
          <button id="howToCloseBtn" style="padding:8px 12px;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Overlay de pausa (mostrado solo durante la partida al pulsar ESC) -->
    <div id="pauseOverlay" class="menu-overlay hidden">
      <div id="pausePanel" style="text-align:center; padding:18px; background:white; border-radius:12px; min-width:320px;">
        <div id="pauseTitle" style="display:block; padding:10px 14px; font-size:16px; font-weight:700; background:#f5f5f5; border-radius:8px; margin-bottom:12px;">Juego en pausa</div>
        <div style="display:flex; gap:10px; justify-content:center; flex-direction:column;">
          <button id="resumeBtn" style="padding:10px 14px; font-size:16px;">Continuar</button>
          <button id="settingsBtnPause" style="padding:10px 14px; font-size:16px;">Configuraciones</button>
          <button id="returnMenuBtn" style="padding:10px 14px; font-size:16px;">Volver al menú principal</button>
        </div>
      </div>
    </div>
    
    <!-- Overlay de Selección de Personaje -->
    <div id="characterOverlay" class="menu-overlay hidden">
      <div id="characterPanel" style="text-align:center; padding:18px; background:white; border-radius:12px; min-width:360px;">
        <h2 style="margin:0 0 12px 0;">Seleccionar personaje</h2>
        <div id="charGrid" style="display:grid; grid-template-columns:repeat(3,1fr); gap:12px;">
          <div class="char-card" data-src="assets/Gatito.png" tabindex="0">
            <img src="assets/Gatito.png" alt="Gatito" style="width:100%; height:90px; object-fit:contain;" />
            <div style="padding:6px 0; font-weight:700;">Gatito</div>
          </div>
          <div class="char-card" data-src="assets/Gatito%202.png" tabindex="0">
            <img src="assets/Gatito%202.png" alt="Gatito 2" style="width:100%; height:90px; object-fit:contain;" />
            <div style="padding:6px 0; font-weight:700;">Gatito 2</div>
          </div>
          <div class="char-card" data-src="assets/Gatito%203.png" tabindex="0">
            <img src="assets/Gatito%203.png" alt="Gatito 3" style="width:100%; height:90px; object-fit:contain;" />
            <div style="padding:6px 0; font-weight:700;">Gatito 3</div>
          </div>
          <div class="char-card" data-src="assets/Gatito%20Banana.png" tabindex="0">
            <img src="assets/Gatito%20Banana.png" alt="Gato Banana" style="width:100%; height:90px; object-fit:contain;" />
            <div style="padding:6px 0; font-weight:700;">Gatito Banana</div>
          </div>
        </div>
        <div style="margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:center;">
          <label style="font-weight:700;">Asignar a:</label>
          <select id="charAssignSelect">
            <option value="1">Jugador 1</option>
            <option value="2">Jugador 2</option>
          </select>
        </div>
        <div style="margin-top:14px; display:flex; gap:10px; justify-content:center;">
          <button id="closeCharBtn" style="padding:6px 10px;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Overlay de Configuraciones (contraste, etc.) -->
    <div id="settingsOverlay" class="menu-overlay hidden">
      <div id="settingsPanel" style="text-align:center; padding:20px; background:white; border-radius:12px; min-width:320px;">
        <h2 style="margin:0 0 10px 0;">Configuraciones</h2>
        <div style="margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:center;">
          <label style="font-weight:700;">Contraste:</label>
          <input id="contrastRangeSettings" class="contrast-range" type="range" min="0" max="100" step="1" value="100" />
          <span id="contrastValue" style="font-weight:700;">100%</span>
        </div>
        <div style="margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:center;">
          <label style="font-weight:700;">Silenciar música:</label>
          <input id="muteCheckbox" type="checkbox" />
        </div>
        <div id="controlsP2Container" style="margin-top:12px; display:flex; gap:8px; align-items:center; justify-content:center;">
          <label style="font-weight:700;">Controles Jugador 2:</label>
          <select id="controlsP2Select">
            <option value="arrows">Flechas</option>
            <option value="ijkl">I J K L</option>
          </select>
        </div>
        <!-- character select moved to its own overlay -->
        <div style="margin-top:16px; display:flex; gap:10px; justify-content:center;">
          <button id="resetContrastBtnSettings" style="padding:6px 10px;">Reset</button>
          <button id="closeSettingsBtn" style="padding:6px 10px;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Overlay de nivel completado -->
    <div id="levelCompleteOverlay" class="menu-overlay hidden">
      <div id="levelCompletePanel" style="text-align:center; padding: 24px; background: white; border-radius:16px;">
        <h2 id="levelCompleteTitle">Nivel completado</h2>
        <p id="levelCompleteTime" style="margin:8px 0 18px 0; font-size:18px;">Tiempo: 00:00</p>
        <div style="display:flex; gap:12px; justify-content:center;">
          <button id="repeatLevelBtn">Repetir partida</button>
          <button id="nextLevelBtn">Siguiente nivel</button>
          <button id="returnMenuFromCompleteBtn">Volver menú principal</button>
        </div>
      </div>
    </div>

    <!-- Overlay de Game Over -->
    <div id="gameOverOverlay" class="menu-overlay hidden">
      <div id="gameOverPanel" style="text-align:center; padding: 24px; background: white; border-radius:16px;">
        <h2 id="gameOverTitle">Game Over</h2>
        <p id="gameOverMsg" style="margin:8px 0 18px 0; font-size:18px;">El gatito fue atrapado...</p>
        <div style="display:flex; gap:12px; justify-content:center;">
          <button id="repeatAfterGameOverBtn">Repetir</button>
          <button id="returnMenuFromGameOverBtn">Volver menú</button>
        </div>
      </div>
    </div>

    <!-- Overlay de Salir (pantalla completa con gatito) -->
    <div id="exitOverlay" class="menu-overlay hidden" style="align-items:center; justify-content:center; background:#000;">
      <div id="exitPanel" style="position:relative; width:25%; height:25%; display:flex; align-items:center; justify-content:center;">
        <img id="exitKittenImg" src="assets/gatito_salir.png" alt="Gatito - Salir" style="width:100vw; height:100vh; object-fit:cover; display:block;" />
        <button id="exitReturnBtn" style="position:absolute; bottom:28px; left:50%; transform:translateX(-50%); padding:12px 18px; font-size:18px; border-radius:8px; background:rgba(255,255,255,0.9);">Regresar</button>
      </div>
    </div>

    <script src="js/engine/GameEngine.js"></script>
    <script src="js/utils/InputHandler.js"></script>
    <script src="js/entities/Kitten.js"></script>
    <script src="js/entities/Trash.js"></script>
    <script src="js/ui/HUD.js"></script>
    <script src="js/game/WaveManager.js"></script>
    <script src="js/game/Game.js"></script>
    <script src="js/entities/Shark.js"></script>
    <script src="js/entities/Crab.js"></script>
    <script src="js/entities/Lighthouse.js"></script>
    <script src="js/main.js"></script>
    <script src="js/menu.js"></script>
</body>
</html>